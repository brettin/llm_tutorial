# Shakespeare
Sam Foreman
[<span class="orcid-green"></span>](https://orcid.org/0000-0002-9981-0876)
2023-11-15

<span style="text-align:left;">[![Open In
Collab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/saforem2/nanoGPT/blob/master/notebooks/ngpt-shakespeare.ipynb)</span>

- [`nanoGPT`](#nanogpt)
- [Install / Setup](#install--setup)
- [First Time Running](#first-time-running)
- [Post Install](#post-install)
- [Build Trainer](#build-trainer)
- [Prompt (**prior** to training)](#prompt-prior-to-training)
- [Train Model](#train-model)
- [Evaluate Model](#evaluate-model)

## Install / Setup

### First Time Running

We need to install `ngpt` and setup the Shakespeare dataset

This will need to be ran the first time you are running this notebook.

Following the

``` python
!python3 -m pip install nanoGPT
```

you will need to restart your runtime (Runtime -\> Restart runtime)

After this, you should be able to

``` python
>>> import ngpt
>>> ngpt.__file__
'/content/nanoGPT/src/ngpt/__init__.py'
```

``` bash
%%bash

python3 -c 'import ngpt; print(ngpt.__file__)' 2> '/dev/null'

if [[ $? -eq 0 ]]; then
    echo "Has ngpt installed. Nothing to do."
else
    echo "Does not have ngpt installed. Installing..."
    git clone 'https://github.com/saforem2/nanoGPT'
    python3 nanoGPT/data/shakespeare_char/prepare.py
    python3 -m pip install -e nanoGPT -vvv
fi
```

<div class="cell-output cell-output-display">

    /lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/__init__.py
    Has ngpt installed. Nothing to do.

</div>

## Post Install

If installed correctly, you should be able to:

``` python
>>> import ngpt
>>> ngpt.__file__
'/path/to/nanoGPT/src/ngpt/__init__.py'
```

``` python
%load_ext autoreload
%autoreload 2

import ngpt
from rich import print
print(ngpt.__file__)
```

<div class="cell-output cell-output-display">

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:monospace">
&#10;    The autoreload extension is already loaded. To reload it, use:
      %reload_ext autoreload
&#10;    <span style="color: #800080; text-decoration-color: #800080">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/</span><span style="color: #ff00ff; text-decoration-color: #ff00ff">__init__.py</span>
&#10;</pre>

</div>

## Build Trainer

Explicitly, we:

1.  `setup_torch(...)`
2.  Build `cfg: DictConfig = get_config(...)`
3.  Instnatiate `config: ExperimentConfig = instantiate(cfg)`
4.  Build `trainer = Trainer(config)`

``` python
import os
import numpy as np
from ezpz import setup_torch
from hydra.utils import instantiate
from ngpt.configs import get_config, PROJECT_ROOT
from ngpt.trainer import Trainer
from enrich.console import get_console

console = get_console()
HF_DATASETS_CACHE = PROJECT_ROOT.joinpath('.cache', 'huggingface')
HF_DATASETS_CACHE.mkdir(exist_ok=True, parents=True)

os.environ['MASTER_PORT'] = '5432'
os.environ['HF_DATASETS_CACHE'] = HF_DATASETS_CACHE.as_posix()

rank = setup_torch('DDP', seed=1234)
cfg = get_config(
    [
        'data=shakespeare',
        'model=shakespeare',
        'optimizer=shakespeare',
        'train=shakespeare',
        'train.dtype=bfloat16',
        'train.max_iters=5000',
        'train.log_interval=250',
        'train.eval_interval=1000',
    ]
)
config = instantiate(cfg)
trainer = Trainer(config)
```

<div class="cell-output cell-output-display">

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:monospace,Menlo,'DejaVu Sans Mono',consolas,'Courier New'">
&#10;    --------------------------------------------------------------------------
    WARNING: There was an error initializing an OpenFabrics device.
    &#10;      Local host:   thetagpu23
      Local device: mlx5_0
    --------------------------------------------------------------------------
    2023-11-15 09:33:41.578337: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  SSE3 SSE4.1 SSE4.2 AVX AVX2 FMA
    To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
&#10;    <span style="color:#838383">[2023-11-15 09:33:44]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[configs.py:263</span><span style="color:#777777">]</span> - Rescaling GAS -> GAS <span style="color:#0A0">/</span><span style="color:#0A0">/</span> WORLD_SIZE = <span style="color:#A0A">1</span> <span style="color:#0A0">/</span><span style="color:#0A0">/</span> <span style="color:#A0A">1</span>
    <span style="color:#838383">[2023-11-15 09:33:44]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[configs.py:398</span><span style="color:#777777">]</span> - Tokens per iteration: <span style="color:#A0A">16</span>,<span style="color:#A0A">384</span>
    <span style="color:#838383">[2023-11-15 09:33:44]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[configs.py:430</span><span style="color:#777777">]</span> - Using <b><</b><b><span style="color:#F5F">torch.amp.autocast_mode.autocast</span></b><span style="color:#FFF"> object at </span><span style="color:#A0A">0x7f588e33ddb0</span><b>></b>
    <span style="color:#838383">[2023-11-15 09:33:44]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[configs.py:436</span><span style="color:#777777">]</span> - Initializing a new model from scratch
    <span style="color:#838383">[2023-11-15 09:33:44]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:179</span><span style="color:#777777">]</span> - Initializing a new model from scratch
    <span style="color:#838383">[2023-11-15 09:33:44]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[model.py:160</span><span style="color:#777777">]</span> - number of parameters: <span style="color:#A0A">10.</span>65M
    <span style="color:#838383">[2023-11-15 09:33:45]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[model.py:290</span><span style="color:#777777">]</span> - num decayed parameter tensors: <span style="color:#A0A">26</span>, with <span style="color:#A0A">10</span>,<span style="color:#A0A">740</span>,<span style="color:#A0A">096</span> parameters
    <span style="color:#838383">[2023-11-15 09:33:45]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[model.py:291</span><span style="color:#777777">]</span> - num non-decayed parameter tensors: <span style="color:#A0A">13</span>, with <span style="color:#A0A">4</span>,<span style="color:#A0A">992</span> parameters
    <span style="color:#838383">[2023-11-15 09:33:46]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[model.py:297</span><span style="color:#777777">]</span> - using fused AdamW: <i><span style="color:#5F5">True</span></i>
    <span style="color:#838383">[2023-11-11 01:15:48]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:179</span><span style="color:#777777">]</span> - Initializing a new model from scratch
    <span style="color:#838383">[2023-11-11 01:15:48]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[model.py:160</span><span style="color:#777777">]</span> - number of parameters: <span style="color:#A0A">10.</span>65M
    <span style="color:#838383">[2023-11-11 01:15:50]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[model.py:290</span><span style="color:#777777">]</span> - num decayed parameter tensors: <span style="color:#A0A">26</span>, with <span style="color:#A0A">10</span>,<span style="color:#A0A">740</span>,<span style="color:#A0A">096</span> parameters
    <span style="color:#838383">[2023-11-11 01:15:50]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[model.py:291</span><span style="color:#777777">]</span> - num non-decayed parameter tensors: <span style="color:#A0A">13</span>, with <span style="color:#A0A">4</span>,<span style="color:#A0A">992</span> parameters
    <span style="color:#838383">[2023-11-11 01:15:50]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[model.py:297</span><span style="color:#777777">]</span> - using fused AdamW: <i><span style="color:#5F5">True</span></i>
&#10;</pre>

</div>

## Prompt (**prior** to training)

``` python
query = "What is a supercomputer?"
outputs = trainer.evaluate(query, num_samples=1, display=False)
console.print(fr'\[prompt]: "{query}"')
console.print("\[response]:\n\n" + fr"{outputs['0']['raw']}")
```

<div class="cell-output cell-output-display">

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:monospace,Menlo,'DejaVu Sans Mono',consolas,'Courier New'">
&#10;    <span style="font-weight: bold">[</span>prompt<span style="font-weight: bold">]</span>: <span style="color: #008000; text-decoration-color: #008000">"What is a supercomputer?"</span>
&#10;    <span style="font-weight: bold">[</span>response<span style="font-weight: bold">]</span>:
&#10;    What is a supercomputer?CbqA-RN?bnss--iadmsD
    S?qJKEwssDq YMSSSFGPxxnJL<span style="color: #00ff00; text-decoration-color: #00ff00; font-weight: bold">DC:c</span>vYfOy
    fiXXe3GQQvYQARdEEbbHHPnWyFp-CwBFrr;g
    WATVAcTZCWWr
    tYCCz,E-wqNbIsMbSvYVONyaQzzcs;Iaa?WOACrnMH'<span style="color: #008000; text-decoration-color: #008000">':dXFEQZa-PYkAvV.B.  F$J-nKnEaZ,'</span>vpesXY&amp;y-M.nIcMVV!GYYVVFh-UX.G&amp;Fa?LSPrkXd3eKV?KJjSZOwSbbhwfIYaywrvRUEuuQMnnIAZS-Ja.fXrMAHB&amp;!!eVbUFwMIkkalHbmRhwwfcj$:s
    RlVhRcaVbYcTTihITDUbbTNMHEdnOibdB-ebuiJLLS:yarlFYHHkSWxB!hbN?nVm3-&amp;djw'BA uS,EQJP3bbWe$hs-g
    :<span style="color: #09a979; text-decoration-color: #09a979; font-weight: bold">3j</span>EEYU
    NkLCetHH lc-IIZEBbb-at
    jyNYmvffVVnERN?LnTM:yS
    sH;are$WRip!jbX'
    e
&#10;    pyA-jbwK 'B$O&amp; Fvvac&amp;sEjbIretcX-H
&#10;</pre>

</div>

<div id="tbl-legend">

|  Name  | Description                   |
|:------:|:------------------------------|
| `step` | *Current training step*       |
| `loss` | *Loss value*                  |
|  `dt`  | *Time per step* (in **ms**)   |
| `sps`  | *Samples per second*          |
| `mtps` | *(million) Tokens per sec*    |
| `mfu`  | *Model Flops utilization*[^1] |

Table 1: Legend

</div>

## Train Model

``` python
trainer.train()
```

<div class="cell-output cell-output-display">

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:monospace,Menlo,'DejaVu Sans Mono',consolas,'Courier New'">
&#10;    <span style="color:#838383">[2023-11-15 09:34:03]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">2</span><span style="color:#A0A">.064</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.412</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.481</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.598</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.594</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.299</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.291</span>
    <span style="color:#838383">[2023-11-15 09:34:10]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.610</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.915</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.153</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.609</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.619</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.299</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.291</span>
    <span style="color:#838383">[2023-11-15 09:34:17]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.432</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.775</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.004</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.590</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.598</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.299</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.291</span>
    <span style="color:#838383">[2023-11-15 09:34:24]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">1000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.346</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.781</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.340</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.612</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.630</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.299</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.291</span>
    <span style="color:#838383">[2023-11-15 09:34:28]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:432</span><span style="color:#777777">]</span> - Saving checkpoint to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/</span><span style="color:#A0A">notebooks</span>
    <span style="color:#838383">[2023-11-15 09:34:28]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:433</span><span style="color:#777777">]</span> - Saving model to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/notebooks/</span><span style="color:#A0A">model.pth</span>
    <span style="color:#838383">[2023-11-15 09:34:28]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[configs.py:129</span><span style="color:#777777">]</span> - Appending <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/</span><span style="color:#A0A">notebooks</span> to <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/ckpts/</span><span style="color:#A0A">checkpoints.log</span>
    <span style="color:#838383">[2023-11-15 09:34:35]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">1250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.309</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.473</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.400</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.596</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.623</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.271</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.520</span>
    <span style="color:#838383">[2023-11-15 09:34:42]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">1500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.225</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.261</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.682</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.601</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.628</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.271</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.520</span>
    <span style="color:#838383">[2023-11-15 09:34:49]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">1750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.176</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.890</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.188</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.609</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.651</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.271</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.520</span>
    <span style="color:#838383">[2023-11-15 09:34:56]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">2000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.163</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.727</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.415</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.613</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.680</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.271</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.520</span>
    <span style="color:#838383">[2023-11-15 09:35:00]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:432</span><span style="color:#777777">]</span> - Saving checkpoint to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/</span><span style="color:#A0A">notebooks</span>
    <span style="color:#838383">[2023-11-15 09:35:00]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:433</span><span style="color:#777777">]</span> - Saving model to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/notebooks/</span><span style="color:#A0A">model.pth</span>
    <span style="color:#838383">[2023-11-15 09:35:00]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[configs.py:129</span><span style="color:#777777">]</span> - Appending <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/</span><span style="color:#A0A">notebooks</span> to <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/ckpts/</span><span style="color:#A0A">checkpoints.log</span>
    <span style="color:#838383">[2023-11-15 09:35:07]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">2250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.120</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.733</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.407</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.613</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.706</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.052</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.471</span>
    <span style="color:#838383">[2023-11-15 09:35:14]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">2500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.068</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.096</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.905</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.605</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.710</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.052</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.471</span>
    <span style="color:#838383">[2023-11-15 09:35:21]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">2750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.027</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.879</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.204</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.610</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.726</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.052</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.471</span>
    <span style="color:#838383">[2023-11-15 09:35:27]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">3000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.002</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.375</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.530</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.599</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.714</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.052</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.471</span>
    <span style="color:#838383">[2023-11-15 09:35:32]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:432</span><span style="color:#777777">]</span> - Saving checkpoint to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/</span><span style="color:#A0A">notebooks</span>
    <span style="color:#838383">[2023-11-15 09:35:32]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:433</span><span style="color:#777777">]</span> - Saving model to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/notebooks/</span><span style="color:#A0A">model.pth</span>
    <span style="color:#838383">[2023-11-15 09:35:32]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[configs.py:129</span><span style="color:#777777">]</span> - Appending <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/</span><span style="color:#A0A">notebooks</span> to <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/ckpts/</span><span style="color:#A0A">checkpoints.log</span>
    <span style="color:#838383">[2023-11-15 09:35:39]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">3250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.950</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.866</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.222</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.610</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.730</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.864</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.531</span>
    <span style="color:#838383">[2023-11-15 09:35:45]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">3500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.926</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.330</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.590</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.599</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.720</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.864</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.531</span>
    <span style="color:#838383">[2023-11-15 09:35:52]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">3750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.916</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.203</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.761</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.602</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.718</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.864</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.531</span>
    <span style="color:#838383">[2023-11-15 09:35:59]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">4000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.901</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.394</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.504</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.598</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.706</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.864</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.531</span>
    <span style="color:#838383">[2023-11-15 09:36:03]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:432</span><span style="color:#777777">]</span> - Saving checkpoint to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/</span><span style="color:#A0A">notebooks</span>
    <span style="color:#838383">[2023-11-15 09:36:03]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:433</span><span style="color:#777777">]</span> - Saving model to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/notebooks/</span><span style="color:#A0A">model.pth</span>
    <span style="color:#838383">[2023-11-15 09:36:03]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[configs.py:129</span><span style="color:#777777">]</span> - Appending <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/</span><span style="color:#A0A">notebooks</span> to <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/ckpts/</span><span style="color:#A0A">checkpoints.log</span>
    <span style="color:#838383">[2023-11-15 09:36:10]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">4250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.840</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.814</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.293</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.611</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.725</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.703</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.615</span>
    <span style="color:#838383">[2023-11-15 09:36:17]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">4500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.850</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.402</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.494</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.598</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.713</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.703</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.615</span>
    <span style="color:#838383">[2023-11-15 09:36:24]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">4750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.824</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.811</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.298</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.611</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.731</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.703</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.615</span>
    <span style="color:#838383">[2023-11-15 09:36:30]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">5000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.819</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.435</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.450</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.597</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.716</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.703</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.615</span>
    <span style="color:#838383">[2023-11-11 01:16:27]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">1000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.332</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.899</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.176</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.609</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.642</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.299</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.291</span>
    <span style="color:#838383">[2023-11-11 01:16:34]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">1250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.277</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.229</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.725</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.602</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.647</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.299</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.291</span>
    <span style="color:#838383">[2023-11-11 01:16:40]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">1500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.234</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.878</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.205</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.610</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.668</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.299</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.291</span>
    <span style="color:#838383">[2023-11-11 01:16:47]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">1750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.175</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.460</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.417</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.597</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.659</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.299</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.291</span>
    <span style="color:#838383">[2023-11-11 01:16:54]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">2000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.140</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.889</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.190</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.609</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.678</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.299</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">4</span><span style="color:#A0A">.291</span>
    <span style="color:#838383">[2023-11-11 01:16:58]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:432</span><span style="color:#777777">]</span> - Saving checkpoint to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/</span><span style="color:#A0A">ngpt</span>
    <span style="color:#838383">[2023-11-11 01:16:58]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:433</span><span style="color:#777777">]</span> - Saving model to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/</span><span style="color:#A0A">model.pth</span>
    <span style="color:#838383">[2023-11-11 01:16:58]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[configs.py:129</span><span style="color:#777777">]</span> - Appending <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/</span><span style="color:#A0A">ngpt</span> to <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/ckpts/</span><span style="color:#A0A">checkpoints.log</span>
    <span style="color:#838383">[2023-11-11 01:17:05]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">2250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.121</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.308</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.619</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.600</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.675</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.050</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.474</span>
    <span style="color:#838383">[2023-11-11 01:17:12]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">2500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.067</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.838</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.261</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.610</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.696</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.050</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.474</span>
    <span style="color:#838383">[2023-11-11 01:17:19]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">2750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.034</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.360</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.550</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.599</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.688</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.050</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.474</span>
    <span style="color:#838383">[2023-11-11 01:17:26]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">3000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.009</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.237</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">38</span><span style="color:#A0A">.114</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.624</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.740</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.050</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.474</span>
    <span style="color:#838383">[2023-11-11 01:17:33]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">3250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.940</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.991</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.050</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.607</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.746</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.050</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.474</span>
    <span style="color:#838383">[2023-11-11 01:17:39]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">3500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.947</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.261</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">38</span><span style="color:#A0A">.080</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.624</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.791</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.050</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.474</span>
    <span style="color:#838383">[2023-11-11 01:17:46]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">3750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.885</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.216</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.870</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.440</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.413</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.050</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.474</span>
    <span style="color:#838383">[2023-11-11 01:17:53]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">4000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.866</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.241</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">38</span><span style="color:#A0A">.108</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.624</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.492</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.050</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.474</span>
    <span style="color:#838383">[2023-11-11 01:17:57]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:432</span><span style="color:#777777">]</span> - Saving checkpoint to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/</span><span style="color:#A0A">ngpt</span>
    <span style="color:#838383">[2023-11-11 01:17:57]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:433</span><span style="color:#777777">]</span> - Saving model to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/</span><span style="color:#A0A">model.pth</span>
    <span style="color:#838383">[2023-11-11 01:17:57]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[configs.py:129</span><span style="color:#777777">]</span> - Appending <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/</span><span style="color:#A0A">ngpt</span> to <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/ckpts/</span><span style="color:#A0A">checkpoints.log</span>
    <span style="color:#838383">[2023-11-11 01:18:04]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">4250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.847</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.228</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.728</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.602</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.511</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.696</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.637</span>
    <span style="color:#838383">[2023-11-11 01:18:11]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">4500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.835</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.215</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">38</span><span style="color:#A0A">.147</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.625</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.581</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.696</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.637</span>
    <span style="color:#838383">[2023-11-11 01:18:18]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">4750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.822</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.657</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.513</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.615</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.621</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.696</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.637</span>
    <span style="color:#838383">[2023-11-11 01:18:24]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">5000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.808</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.635</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.544</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.615</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.658</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.696</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.637</span>
    <span style="color:#838383">[2023-11-11 01:18:31]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">5250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.811</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.267</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">38</span><span style="color:#A0A">.071</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.624</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.711</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.696</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.637</span>
    <span style="color:#838383">[2023-11-11 01:18:38]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">5500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.769</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.406</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.870</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.620</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.751</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.696</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.637</span>
    <span style="color:#838383">[2023-11-11 01:18:44]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">5750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.780</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.239</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">38</span><span style="color:#A0A">.111</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.624</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.796</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.696</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.637</span>
    <span style="color:#838383">[2023-11-11 01:18:51]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">6000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.767</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.682</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.478</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.614</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.813</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.696</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.637</span>
    <span style="color:#838383">[2023-11-11 01:18:55]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:432</span><span style="color:#777777">]</span> - Saving checkpoint to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/</span><span style="color:#A0A">ngpt</span>
    <span style="color:#838383">[2023-11-11 01:18:55]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:433</span><span style="color:#777777">]</span> - Saving model to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/</span><span style="color:#A0A">model.pth</span>
    <span style="color:#838383">[2023-11-11 01:18:56]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[configs.py:129</span><span style="color:#777777">]</span> - Appending <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/</span><span style="color:#A0A">ngpt</span> to <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/ckpts/</span><span style="color:#A0A">checkpoints.log</span>
    <span style="color:#838383">[2023-11-11 01:19:02]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">6250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.773</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">31</span><span style="color:#A0A">.104</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">32</span><span style="color:#A0A">.151</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.527</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.629</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.556</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.755</span>
    <span style="color:#838383">[2023-11-11 01:19:09]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">6500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.759</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.142</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.843</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.604</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.639</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.556</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.755</span>
    <span style="color:#838383">[2023-11-11 01:19:16]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">6750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.753</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.712</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.437</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.613</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.670</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.556</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.755</span>
    <span style="color:#838383">[2023-11-11 01:19:22]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">7000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.745</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.871</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.215</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.610</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.690</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.556</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.755</span>
    <span style="color:#838383">[2023-11-11 01:19:29]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">7250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.733</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.266</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">38</span><span style="color:#A0A">.072</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.624</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.740</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.556</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.755</span>
    <span style="color:#838383">[2023-11-11 01:19:36]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">7500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.723</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.817</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.289</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.611</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.755</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.556</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.755</span>
    <span style="color:#838383">[2023-11-11 01:19:43]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">7750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.747</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.461</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.791</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.619</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.788</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.556</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.755</span>
    <span style="color:#838383">[2023-11-11 01:19:49]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">8000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.729</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">29</span><span style="color:#A0A">.348</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">34</span><span style="color:#A0A">.074</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.558</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.679</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.556</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.755</span>
    <span style="color:#838383">[2023-11-11 01:19:53]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:432</span><span style="color:#777777">]</span> - Saving checkpoint to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/</span><span style="color:#A0A">ngpt</span>
    <span style="color:#838383">[2023-11-11 01:19:53]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:433</span><span style="color:#777777">]</span> - Saving model to: <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/</span><span style="color:#A0A">model.pth</span>
    <span style="color:#838383">[2023-11-11 01:19:54]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[configs.py:129</span><span style="color:#777777">]</span> - Appending <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/</span><span style="color:#A0A">ngpt</span> to <span style="color:#0A0">/lus/grand/projects/datascience/foremans/locations/thetaGPU/projects/saforem2/nanoGPT/src/ngpt/ckpts/</span><span style="color:#A0A">checkpoints.log</span>
    <span style="color:#838383">[2023-11-11 01:20:01]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">8250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.718</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.464</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.787</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.619</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.719</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.473</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.840</span>
    <span style="color:#838383">[2023-11-11 01:20:07]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">8500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.705</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.051</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.967</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.606</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.725</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.473</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.840</span>
    <span style="color:#838383">[2023-11-11 01:20:14]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">8750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.704</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.298</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">38</span><span style="color:#A0A">.026</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.623</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.769</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.473</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.840</span>
    <span style="color:#838383">[2023-11-11 01:20:21]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">9000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.694</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.131</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.858</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.604</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.766</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.473</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.840</span>
    <span style="color:#838383">[2023-11-11 01:20:27]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">9250</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.700</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.291</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">38</span><span style="color:#A0A">.036</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.623</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.806</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.473</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.840</span>
    <span style="color:#838383">[2023-11-11 01:20:34]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">9500</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.668</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">27</span><span style="color:#A0A">.353</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">36</span><span style="color:#A0A">.560</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.599</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.788</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.473</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.840</span>
    <span style="color:#838383">[2023-11-11 01:20:41]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">9750</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.658</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.422</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.847</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.620</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.819</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.473</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.840</span>
    <span style="color:#838383">[2023-11-11 01:20:48]</span><span style="color:#2196F3">[INFO]</span><span style="color:#777777">[trainer.py:516</span><span style="color:#777777">]</span> - <i><span style="color:#55F">step</span></i>=<span style="color:#A0A">10000</span> <i><span style="color:#55F">loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.678</span> <i><span style="color:#55F">dt</span></i>=<span style="color:#A0A">26</span><span style="color:#A0A">.887</span> <i><span style="color:#55F">sps</span></i>=<span style="color:#A0A">37</span><span style="color:#A0A">.192</span> <i><span style="color:#55F">mtps</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.609</span> <i><span style="color:#55F">mfu</span></i>=<span style="color:#A0A">13</span><span style="color:#A0A">.823</span> <i><span style="color:#55F">train_loss</span></i>=<span style="color:#A0A">0</span><span style="color:#A0A">.473</span> <i><span style="color:#55F">val_loss</span></i>=<span style="color:#A0A">1</span><span style="color:#A0A">.840</span>
&#10;  </pre>

</div>

## Evaluate Model

``` python
query = "What is a supercomputer?"
outputs = trainer.evaluate(query, num_samples=1, display=False)
console.print(fr'\[prompt]: "{query}"')
console.print("\[response]:\n\n" + fr"{outputs['0']['raw']}")
```

<div class="cell-output cell-output-display">

<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:monospace,Menlo,'DejaVu Sans Mono',consolas,'Courier New'">
&#10;    <span style="font-weight: bold">[</span>prompt<span style="font-weight: bold">]</span>: <span style="color: #008000; text-decoration-color: #008000">"What is a supercomputer?"</span>
&#10;    <span style="font-weight: bold">[</span>response<span style="font-weight: bold">]</span>:
&#10;    What is a supercomputer?
    How now, now! what news?
    Have thy sons?
&#10;    Messenger:
    The queen is his noble consul;
    The man I am a lord's, and he received:
    Therefore, consider and the hand of death.
&#10;    SIR STEPHEN SCROOP:
    Peace, hope, my lord; I am not thy name;
    For I have need of this cause is so long.
&#10;    BISHOP OF ELY:
    Believe me, I will practise your majesty.
    Be remember thy thoughts: give me and brothers,
    And towards London, till I were common all.
&#10;    BUCKINGHAM:
    Northumberland, so proud weighing to fight.
&#10;    GLOUCESTER:
    Relent, e
&#10;</pre>

</div>

[^1]: in units of A100 `bfloat16` peak FLOPS
